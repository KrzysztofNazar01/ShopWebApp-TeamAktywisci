version: "3"
services:
  prestadb:
    build: ./db
    #restart: always
    #container_name: prestadb
    command: --default-authentication-plugin=mysql_native_password
    environment:
      - MYSQL_DATABASE=prestadb # name of db
      - MYSQL_ROOT_PASSWORD=admin
    # ports:
    #   - "3306:3306"
    networks:
      - prestashop # name of network - allow containers to communicate with
                   # each other
  
  prestashop:
    build: ./prestashop
    restart: always
    depends_on:
      - prestadb
    environment:
      - PS_DEV_MODE=1
      - DB_SERVER=prestadb
      - DB_NAME=prestadb
      - DB_USER=root
      - DB_PASSWD=admin
      - PS_INSTALL_AUTO=0
      - ADMIN_MAIL=piegusek20@gmail.com
      - ADMIN_PASSWD=asddsa123321!
      - PS_DOMAIN=localhost
    volumes:
      - ./volumeDirectory:/volumeDirectory
      #prestashop  
    ports: 
      - "80:80"
      - "443:443"
    networks:
      - prestashop
    #command: command
  
  phpmyadmin:
    image: phpmyadmin
    restart: always
    ports:
      - 8082:80
    networks:
      - prestashop
    environment:
      PMA_ARBITRARY: 1
      PMA_HOST: prestadb
      MYSQL_USERNAME: root
      MYSQL_ROOT_PASSWORD: admin

  mail:
    image: bytemark/smtp
    restart: always
    environment:
      RELAY_HOST: smtp.student.pg.edu.pl
      RELAY_PORT: 587
      RELAY_USERNAME: s184546@student.pg.edu.pl
      RELAY_PASSWORD: 
    networks:
      - prestashop


networks:
  prestashop:
